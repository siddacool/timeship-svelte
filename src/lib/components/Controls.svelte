<script lang="ts">
  import { cities } from '$lib/stores/cities';
  import { clocks } from '$lib/stores/clocks';
  import { general } from '$lib/stores/general';
  import ButtonTextToggle from './ui/ButtonTextToggle.svelte';

  const onSearchClick = () => {
    if (!$cities?.cities.length) {
      cities.fetchData();
    }

    general.setSearchModal(true);
  };

  const onSettingsClick = () => {
    general.setSettingsModal(true);
  };
</script>

<div
  class="contol"
  class:hide={$general.reorder}
  class:noClocks={!$clocks.length && !$general.reorder ? true : false}
>
  <ButtonTextToggle
    name="add city"
    elevation
    color="white"
    on:click={onSearchClick}
    responsive
    showText={!$clocks.length && !$general.reorder ? true : false}
    class="add-city"
  >
    <svg
      width="33"
      height="33"
      viewBox="0 0 33 33"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      slot="icon"
    >
      <mask
        id="mask0_20_76"
        style="mask-type:alpha"
        maskUnits="userSpaceOnUse"
        x="0"
        y="0"
        width="33"
        height="33"
      >
        <rect x="0.833344" y="0.666626" width="32" height="32" fill="#D9D9D9" />
      </mask>
      <g mask="url(#mask0_20_76)">
        <path
          d="M4.63334 12.7333C4.18889 12.7333 3.82223 12.5889 3.53334 12.3C3.24445 12.0111 3.10001 11.6444 3.10001 11.2C3.10001 10.7777 3.24445 10.4222 3.53334 10.1333C3.82223 9.84442 4.18889 9.69997 4.63334 9.69997H8.73334C9.15556 9.69997 9.5169 9.84442 9.81734 10.1333C10.1169 10.4222 10.2667 10.7777 10.2667 11.2C10.2667 11.6444 10.1169 12.0111 9.81734 12.3C9.5169 12.5889 9.15556 12.7333 8.73334 12.7333H4.63334ZM4.63334 19.5333C4.18889 19.5333 3.82223 19.3831 3.53334 19.0826C3.24445 18.7831 3.10001 18.4222 3.10001 18C3.10001 17.5777 3.24445 17.2169 3.53334 16.9173C3.82223 16.6169 4.18889 16.4666 4.63334 16.4666H8.73334C9.15556 16.4666 9.5169 16.6169 9.81734 16.9173C10.1169 17.2169 10.2667 17.5777 10.2667 18C10.2667 18.4222 10.1169 18.7831 9.81734 19.0826C9.5169 19.3831 9.15556 19.5333 8.73334 19.5333H4.63334ZM27.5 25.0666L23.3667 20.9333C22.8333 21.3111 22.2502 21.5946 21.6173 21.784C20.9836 21.9724 20.3333 22.0666 19.6667 22.0666C17.7778 22.0666 16.1667 21.4 14.8333 20.0666C13.5 18.7333 12.8333 17.1111 12.8333 15.2C12.8333 13.3111 13.5 11.7 14.8333 10.3666C16.1667 9.0333 17.7778 8.36664 19.6667 8.36664C21.5778 8.36664 23.2 9.0333 24.5333 10.3666C25.8667 11.7 26.5333 13.3111 26.5333 15.2C26.5333 15.8666 26.4387 16.5164 26.2493 17.1493C26.0609 17.7831 25.7778 18.3666 25.4 18.9L29.5333 23.0333C29.8222 23.3 29.9667 23.6391 29.9667 24.0506C29.9667 24.4613 29.8222 24.8 29.5333 25.0666C29.2667 25.3555 28.9333 25.5 28.5333 25.5C28.1333 25.5 27.7889 25.3555 27.5 25.0666ZM19.6667 19.1333C20.7778 19.1333 21.7169 18.7555 22.484 18C23.2502 17.2444 23.6333 16.3111 23.6333 15.2C23.6333 14.1111 23.2502 13.1831 22.484 12.416C21.7169 11.6497 20.7778 11.2666 19.6667 11.2666C18.5778 11.2666 17.6502 11.6497 16.884 12.416C16.1169 13.1831 15.7333 14.1111 15.7333 15.2C15.7333 16.3111 16.1169 17.2444 16.884 18C17.6502 18.7555 18.5778 19.1333 19.6667 19.1333ZM4.63334 26.3C4.18889 26.3 3.82223 26.1555 3.53334 25.8666C3.24445 25.5777 3.10001 25.2222 3.10001 24.8C3.10001 24.3555 3.24445 23.9889 3.53334 23.7C3.82223 23.4111 4.18889 23.2666 4.63334 23.2666H15.1667C15.5889 23.2666 15.9445 23.4111 16.2333 23.7C16.5222 23.9889 16.6667 24.3555 16.6667 24.8C16.6667 25.2222 16.5222 25.5777 16.2333 25.8666C15.9445 26.1555 15.5889 26.3 15.1667 26.3H4.63334Z"
          fill="currentColor"
        />
      </g>
    </svg>

    Add City
  </ButtonTextToggle>

  <ButtonTextToggle
    elevation
    name="Settings"
    color="white"
    responsive
    showText={!$clocks.length && !$general.reorder ? true : false}
    on:click={onSettingsClick}
    class="settings"
  >
    <svg
      width="27"
      height="27"
      viewBox="0 0 27 27"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      slot="icon"
    >
      <mask
        id="mask0_20_71"
        style="mask-type:alpha"
        maskUnits="userSpaceOnUse"
        x="0"
        y="0"
        width="27"
        height="27"
      >
        <rect x="0.833313" y="0.666656" width="26" height="26" fill="#D9D9D9" />
      </mask>
      <g mask="url(#mask0_20_71)">
        <path
          d="M15.9188 24.7166H11.7479C11.441 24.7166 11.1748 24.613 10.9495 24.4057C10.7235 24.1977 10.5833 23.9402 10.5292 23.6333L10.2313 21.1958C10.0146 21.1055 9.82031 21.0062 9.64843 20.8979C9.47726 20.7896 9.3014 20.6722 9.12084 20.5458L6.81876 21.5208C6.52987 21.6291 6.24098 21.6382 5.95209 21.5479C5.6632 21.4576 5.43751 21.2771 5.27501 21.0062L3.21667 17.4041C3.05417 17.1333 3.00434 16.8444 3.06717 16.5375C3.13073 16.2305 3.27987 15.9868 3.51459 15.8062L5.49168 14.2896V13.0437L3.51459 11.5271C3.27987 11.3465 3.13073 11.1027 3.06717 10.7958C3.00434 10.4889 3.05417 10.2 3.21667 9.92914L5.27501 6.32705C5.41945 6.05622 5.64081 5.88 5.93909 5.79839C6.23665 5.7175 6.52987 5.73122 6.81876 5.83955L9.14793 6.78747C9.31043 6.66108 9.48195 6.54372 9.66251 6.43539C9.84306 6.32705 10.0326 6.23678 10.2313 6.16455L10.5292 3.69997C10.5833 3.37497 10.7235 3.11317 10.9495 2.91455C11.1748 2.71594 11.441 2.61664 11.7479 2.61664H15.9188C16.2257 2.61664 16.4922 2.71594 16.7183 2.91455C16.9436 3.11317 17.0833 3.37497 17.1375 3.69997L17.4354 6.16455C17.6521 6.23678 17.8464 6.32705 18.0183 6.43539C18.1894 6.54372 18.3653 6.66108 18.5458 6.78747L20.8479 5.83955C21.1368 5.73122 21.4257 5.7175 21.7146 5.79839C22.0035 5.88 22.2292 6.05622 22.3917 6.32705L24.45 9.92914C24.6125 10.2 24.6667 10.4889 24.6125 10.7958C24.5583 11.1027 24.4049 11.3465 24.1521 11.5271L22.1479 13.0437C22.166 13.1521 22.175 13.2557 22.175 13.3546V13.9776C22.175 14.0772 22.157 14.1812 22.1208 14.2896L24.125 15.8062C24.3597 15.9868 24.5089 16.2305 24.5724 16.5375C24.6353 16.8444 24.5854 17.1333 24.4229 17.4041L22.3646 20.9791C22.2021 21.25 21.9721 21.4349 21.6745 21.5338C21.3762 21.6335 21.0826 21.6291 20.7938 21.5208L18.5188 20.5458C18.3563 20.6722 18.1847 20.7896 18.0042 20.8979C17.8236 21.0062 17.634 21.1055 17.4354 21.1958L17.1375 23.6333C17.0833 23.9402 16.9436 24.1977 16.7183 24.4057C16.4922 24.613 16.2257 24.7166 15.9188 24.7166ZM13.8604 17.4583C14.9076 17.4583 15.8014 17.0882 16.5417 16.3479C17.282 15.6076 17.6521 14.7139 17.6521 13.6666C17.6521 12.6194 17.282 11.7257 16.5417 10.9854C15.8014 10.2451 14.9076 9.87497 13.8604 9.87497C12.8132 9.87497 11.9195 10.2451 11.1792 10.9854C10.4389 11.7257 10.0688 12.6194 10.0688 13.6666C10.0688 14.7139 10.4389 15.6076 11.1792 16.3479C11.9195 17.0882 12.8132 17.4583 13.8604 17.4583ZM13.8604 15.2916C13.409 15.2916 13.0255 15.1335 12.7099 14.8171C12.3936 14.5015 12.2354 14.118 12.2354 13.6666C12.2354 13.2152 12.3936 12.8317 12.7099 12.5161C13.0255 12.1998 13.409 12.0416 13.8604 12.0416C14.3118 12.0416 14.6957 12.1998 15.012 12.5161C15.3276 12.8317 15.4854 13.2152 15.4854 13.6666C15.4854 14.118 15.3276 14.5015 15.012 14.8171C14.6957 15.1335 14.3118 15.2916 13.8604 15.2916ZM12.8313 22.2521H14.8083L15.1875 19.4083C15.7653 19.2639 16.2979 19.0472 16.7854 18.7583C17.2729 18.4694 17.7153 18.1173 18.1125 17.7021L20.7938 18.8125L21.7688 17.1062L19.4396 15.3458C19.5299 15.093 19.5978 14.8222 19.6433 14.5333C19.688 14.2444 19.7104 13.9555 19.7104 13.6666C19.7104 13.3777 19.688 13.0889 19.6433 12.8C19.5978 12.5111 19.5299 12.2402 19.4396 11.9875L21.7688 10.2271L20.7938 8.5208L18.1125 9.6583C17.7153 9.22497 17.2729 8.86386 16.7854 8.57497C16.2979 8.28608 15.7653 8.06941 15.1875 7.92497L14.8354 5.08122H12.8313L12.4792 7.92497C11.9014 8.06941 11.3688 8.28608 10.8813 8.57497C10.3938 8.86386 9.94237 9.21594 9.52709 9.63122L6.87292 8.5208L5.89793 10.2271L8.20001 11.9604C8.10973 12.2312 8.0422 12.5067 7.99743 12.787C7.95193 13.0665 7.92918 13.3597 7.92918 13.6666C7.92918 13.9555 7.95193 14.2397 7.99743 14.5192C8.0422 14.7994 8.10973 15.084 8.20001 15.3729L5.89793 17.1062L6.87292 18.8125L9.52709 17.7021C9.94237 18.1173 10.3938 18.4694 10.8813 18.7583C11.3688 19.0472 11.9014 19.2639 12.4792 19.4083L12.8313 22.2521Z"
          fill="currentColor"
        />
      </g>
    </svg>

    Settings
  </ButtonTextToggle>
</div>

<style lang="scss">
  .contol {
    position: fixed;
    bottom: 14px;
    right: 16px;
    transition: transform 200ms;

    &.hide {
      transform: translate(74px, 0);

      @media (min-width: 1024px) {
        transform: translate(330px, 0);
      }
    }

    &.noClocks {
      @media (max-width: 1023px) {
        display: flex;
        position: static;
        transform: translate(0, 0);
        align-items: center;
        justify-content: center;
        margin-top: 30px;
      }

      :global(.button-text-toogle) {
        @media (max-width: 1023px) {
          margin-right: 16px;
        }
      }
    }

    @media (min-width: 1024px) {
      top: 16px;
      bottom: initial;
      right: 16px;
    }

    @media (min-width: 1400px) {
      display: flex;
      right: 40px;
    }

    :global(.button-text-toogle) {
      width: 55px;
      height: 55px;
      margin-bottom: 16px;

      @media (min-width: 1400px) {
        margin-right: 16px;
        margin-bottom: 0;
      }
    }

    :global(.button-text-toogle-showText) {
      width: initial;
    }

    :global(svg) {
      margin-right: 0;
    }

    :global(.add-city) {
      background-color: var(--color-bg-button-main);

      &:hover {
        background-color: var(--color-bg-button-main-hover);
      }

      &:active {
        background-color: var(--color-bg-button-main-active);
      }
    }

    :global(.settings) {
      background-color: var(--color-bg-button-secondary);

      &:hover {
        background-color: var(--color-bg-button-secondary-hover);
      }

      &:active {
        background-color: var(--color-bg-button-secondary-active);
      }
    }
  }
</style>
